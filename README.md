## 人脸识别与管理系统123

### 项目简介

这是一个基于 PyQt5 、Fastapi和 YOLOv8（或其他后端模型）开发的人脸识别与管理系统。它提供了一个用户友好的图形界面，用于人脸信息的录入、实时人脸识别以及人脸数据库的管理。此外，本系统还集成了疲劳监测系统的切换功能，方便用户在不同应用场景间切换。

### 主要功能

- **用户认证**：提供登录和注册功能，通过 SQLite 数据库 `user.db` 管理用户账户。
- **人脸信息录入**：支持通过图片文件选择或摄像头实时采集人脸图像，并结合姓名、年龄、性别等信息进行录入。
- **实时人脸识别**：利用摄像头进行实时视频流人脸检测与识别，并在界面上显示识别结果及人脸框。
- **人脸数据库管理**：独立的数据库管理界面，允许用户查看、刷新、删除、修改和手动添加人脸数据。人脸特征（embedding）存储在 `face_db.sqlite` 数据库中。
- **后端集成**：通过 HTTP 请求与后端服务进行通信，执行人脸检测、识别和数据操作。
- **疲劳监测系统切换**：一键切换至外部的疲劳监测系统，扩展了应用场景。

### 项目结构

```
face_recoginition_myself/
├── app.py                  # 主应用程序文件，实现人脸识别与管理系统的核心界面和逻辑
├── login.py                # 用户登录和注册模块
├── user_manager.py         # 用户管理模块（如果启用）
├── face_db_manager.py      # 人脸数据库管理界面模块
├── face_db.sqlite          # 人脸数据存储数据库
├── user.db                 # 用户账户信息数据库
├── main.py                 # 项目启动入口
├── data.yaml               # YOLOv8模型训练所需的数据配置文件
├── train.py                # 人脸识别模型训练脚本（如果包含）
├── remember.conf           # 存储"记住密码"的用户信息
├── runs/                   # YOLOv8模型训练结果及日志
│   └── detect/
│       └── myexp2/         # 训练实验结果示例
│           ├── weights/
│           │   ├── best.pt # 最佳模型权重
│           │   └── last.pt # 最新模型权重
│           └── ...
└── dataset/                # 人脸数据集目录
    └── mydata.yaml
    └── train/
    │   ├── images/
    │   └── labels/
    └── valid/
        ├── images/
        └── labels/
```

### 环境配置

1. **Python 环境**：确保您的系统安装了 Python 3.x。
2. **安装依赖**：

   ```bash
   pip install -r requirements.txt
   ```

   （如果 `requirements.txt` 不存在，您可能需要手动安装以下库：`PyQt5`, `opencv-python`, `requests`, `numpy`, `Pillow`, `ultralytics` (如果使用 YOLOv8)，`sqlite3` (Python 内置)。）
3. **后端服务**：
   本项目依赖于一个后端服务来执行实际的人脸检测和识别。请确保您的后端服务已启动并可通过 `http://127.0.0.1:8002` 访问。后端服务的具体实现（例如基于 FastAPI 或 Flask）不在本项目代码库中提供，需要单独部署。

### 后端 API 接口说明

本项目前端通过 HTTP 请求与后端服务进行通信。后端服务应提供以下主要 API 接口：

- **GET `/list_faces/`**: 用于前端查询和展示已注册的人脸列表。
- **POST `/recognize/`**: 接收图片数据，后端进行人脸检测和识别，并返回识别到的人脸信息（如姓名、年龄、性别和边界框坐标）。
- **POST `/add_face/`**: 接收新的人脸信息（包括姓名、年龄、性别、图片文件或图片路径），后端负责提取人脸特征并将其录入数据库。

### 运行项目

1. **启动后端服务**：main.py
2. **启动前端应用**：

   ```bash
   python app.py
   ```
3. **登录或注册**：
   运行 `login.py` 后，将会显示登录界面。您可以选择注册新用户或使用已有账户登录。
4. **使用系统**：
   登录成功后，即可进入人脸识别与管理系统主界面，开始进行人脸信息录入、识别或数据库管理操作。

### 注意事项

- **人脸特征维度**：本系统在启动人脸数据库管理界面时会检查 `face_db.sqlite` 中人脸特征（embedding）的维度。如果发现非 `(512,)` 维的特征，系统会自动删除这些无效数据。
- **图片路径**：在人脸信息录入和数据库管理中，图片路径应确保有效且可访问。
